:root{
  --bg:#0f0e0d; /* deep charcoal */
  --panel:#151412;
  --text:#f4efe8;
  --muted:#c7c0b7;
  --brown:#9b7e5a; /* her fav */
  --grey:#6d6d6d;  /* her fav */
  --accent:#e7cba9; /* elegant highlight */
}

*{ box-sizing:border-box }
html,body{ height:100% }
body{
  margin:0; background: radial-gradient(1200px 800px at 80% -10%, #2a2928, var(--bg));
  color:var(--text); font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  line-height:1.6; -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
}

.hidden{ display:none }
body.app-ready #preloader{ display:none }

/* Welcome overlay */
.welcome{ position:fixed; inset:0; display:grid; place-items:center; background:rgba(0,0,0,.6); z-index:45; pointer-events:none }
.welcome-card{ background:linear-gradient(160deg, #1a1917, #151412); border:1px solid #3a342b; padding:18px 20px; border-radius:16px; width:min(520px, 92vw); text-align:center; box-shadow:0 20px 60px rgba(0,0,0,.5) }
.welcome-title{ font-family:'Playfair Display', serif; font-size:28px; margin-bottom:6px }
.welcome-text{ color:#e7e1d8 }

/* Nudge popup */
.nudge{ position:fixed; inset:0; display:grid; place-items:center; background:rgba(0,0,0,.55); z-index:70 }
.nudge-card{ width:min(460px, 92vw); background:linear-gradient(160deg,#1a1917,#151412); border:1px solid #3a342b; border-radius:16px; box-shadow:0 24px 80px rgba(0,0,0,.6); padding:16px 18px; text-align:center }
.nudge-msg{ color:#e7e1d8; margin:6px 0 12px; font-size:16px }
.nudge-actions{ display:flex; justify-content:center; gap:8px }

/* Preloader */
#preloader{ position:fixed; inset:0; display:grid; place-items:center; background:linear-gradient(160deg, #1a1918, #10100f); z-index:50 }
.preloader-inner{ text-align:center }
.preloader-inner .logo{ font-family: 'Playfair Display', serif; font-size:28px; letter-spacing:0.5px; margin-bottom:12px }
.spinner{ width:36px; height:36px; border:3px solid #3a3a38; border-top-color:var(--accent); border-radius:50%; margin:0 auto 10px; animation:spin 1s linear infinite }
.hint{ color:#9a958e; font-size:12px }
@keyframes spin{ to{ transform:rotate(360deg) } }

/* Layout */
.app-header{ display:flex; align-items:center; justify-content:space-between; padding:18px 22px; position:sticky; top:0; background:linear-gradient(180deg, rgba(15,14,13,.95), rgba(15,14,13,.6), rgba(15,14,13,0)); backdrop-filter: blur(4px); z-index:10 }
.app-header .title .eyebrow{ text-transform:uppercase; letter-spacing:.2em; color:var(--muted); font-size:12px }
.app-header h1{ margin:4px 0 0; font-family:'Playfair Display', serif; font-weight:700; font-size:28px }
.controls{ display:flex; gap:10px }
.btn{ background: linear-gradient(180deg, #2a291f, #1e1c16); color:var(--text); border:1px solid #3a3328; border-radius:999px; padding:10px 14px; font-weight:600; cursor:pointer; transition:transform .06s ease, box-shadow .2s ease }
.btn:hover{ transform:translateY(-1px); box-shadow:0 6px 16px rgba(0,0,0,.35) }
.btn-ghost{ background: transparent; border-color:#3a3a38 }

.map{ padding:10px 12px 0 }
#timeline{ width:100%; height:auto; pointer-events:auto }
#nodes{ pointer-events:auto }
.hit{ cursor:pointer }
.hit{ pointer-events: all }
.node{ pointer-events:auto }
.node{ fill:var(--brown); stroke:#fff; stroke-width:2; cursor:pointer; filter: drop-shadow(0 6px 10px rgba(0,0,0,.3)); }
.node, .hit{ touch-action: manipulation }
.node.active{ fill:var(--accent) }
/* Locked state */
.node.locked{ fill:#5a4b3a; opacity:.6 }
text.label{ fill:var(--muted); font-size:12px; pointer-events:none }

/* Node hover pulse */
.node{ transition: transform .12s ease }
.node:hover{ transform: scale(1.08) }
.node.lit{ box-shadow: 0 0 0 3px rgba(231,203,169,.25) }

.legend{ display:flex; gap:16px; color:var(--muted); padding:6px 18px 12px; font-size:13px }
.legend .dot{ width:10px; height:10px; background:var(--brown); border-radius:50%; display:inline-block; margin-right:6px }
.legend .dot-secondary{ background:var(--grey) }

.app-footer{ display:flex; justify-content:space-between; align-items:center; padding:14px 18px 22px; color:#bdb7ae; font-size:12px }
.petnames{ letter-spacing:.08em; text-transform:uppercase }

/* Modal */
.modal{ position:fixed; inset:0; display:grid; place-items:center; z-index:40 }
.modal.hidden{ display:none }
.modal-backdrop{ position:absolute; inset:0; background:rgba(0,0,0,.55); backdrop-filter: blur(2px) }
.modal-card{ position:relative; width:min(920px, 92vw); max-height:92vh; display:grid; grid-template-columns: 1.2fr 1fr; background:linear-gradient(160deg, #1a1917, #151412); border:1px solid #3a342b; border-radius:18px; overflow:hidden; box-shadow: 0 24px 80px rgba(0,0,0,.6) }
.modal-close{ position:absolute; top:10px; right:12px; width:36px; height:36px; border-radius:999px; border:1px solid #3b3b3b; background:#222; color:#fff; cursor:pointer }
.modal-media{ background:#0c0b0a; display:grid; place-items:center }
.modal-media img{ width:100%; height:100%; object-fit:cover }
.modal-body{ padding:18px 18px 16px; overflow:auto }
.modal-body h2{ font-family:'Playfair Display', serif; font-weight:700; margin:6px 0 8px; font-size:28px }
.modal-body p{ color:#e7e1d8; margin:0 0 10px }
.modal-actions{ display:flex; justify-content:flex-end; gap:8px; margin-top:10px }

/* Tablet-first tweaks */
@media (max-width: 900px){
  .modal-card{ grid-template-columns:1fr; max-height:96vh }
  .modal-media{ height:46vh }
  .modal-body{ padding:14px }
  .modal-body h2{ font-size:22px }
}

@media (max-width: 600px){
  .app-header h1{ font-size:22px }
  .controls .btn{ padding:8px 10px; font-size:13px }
  .legend{ font-size:12px }
  .modal-media{ height:42vh }
}

/* Gate input aesthetics */
.gate-input{ background:#111; border:1px solid #3a3a38; color:#fff; border-radius:10px }


